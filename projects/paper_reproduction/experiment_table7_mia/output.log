nohup: ignoring input
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified

================ Run 1/1 ================

[TRAIN] Step 1/5: train original
    Epoch 1/30  30.95s
    Epoch 2/30  29.55s
    Epoch 3/30  29.44s
    Epoch 4/30  29.66s
    Epoch 5/30  29.69s
    Epoch 6/30  29.67s
    Epoch 7/30  29.61s
    Epoch 8/30  29.61s
    Epoch 9/30  29.44s
    Epoch 10/30  29.61s
    Epoch 11/30  29.55s
    Epoch 12/30  29.61s
    Epoch 13/30  28.20s
    Epoch 14/30  29.29s
    Epoch 15/30  29.17s
    Epoch 16/30  28.97s
    Epoch 17/30  27.77s
    Epoch 18/30  28.25s
    Epoch 19/30  29.29s
    Epoch 20/30  28.81s
    Epoch 21/30  29.74s
    Epoch 22/30  29.59s
    Epoch 23/30  29.73s
    Epoch 24/30  29.53s
    Epoch 25/30  29.76s
    Epoch 26/30  29.69s
    Epoch 27/30  30.52s
    Epoch 28/30  30.18s
    Epoch 29/30  29.76s
    Epoch 30/30  30.42s
Creating ES partitions (paper-accurate)...
ES scores (ascending): [37.550314, 46.24586, 73.898726]
[sanity] Low ES: set-ES(mean) = -2.633574  (n=3000)
[sanity] Medium ES: set-ES(mean) = -7.299782  (n=3000)
[sanity] High ES: set-ES(mean) = -11.261629  (n=3000)
[sanity] ES scores (ascending): ['High ES:-11.261629', 'Medium ES:-7.299782', 'Low ES:-2.633574']

--- ES Level: Low ES ---
[Low ES / retain_eval (orig)] n=47000  Acc=93.45  loss=0.191  entr=0.230  margin=5.050
[Low ES / forget_eval (orig)] n=3000  Acc=66.27  loss=0.948  entr=1.030  margin=1.369
[TRAIN] Step 2/5: retrain on retain (augment O)
    Epoch 1/30  28.64s
    Epoch 2/30  28.19s
    Epoch 3/30  28.33s
    Epoch 4/30  28.04s
    Epoch 5/30  28.07s
    Epoch 6/30  28.43s
    Epoch 7/30  28.58s
    Epoch 8/30  28.37s
    Epoch 9/30  28.26s
    Epoch 10/30  28.37s
    Epoch 11/30  28.47s
    Epoch 12/30  28.15s
    Epoch 13/30  28.08s
    Epoch 14/30  28.31s
    Epoch 15/30  28.18s
    Epoch 16/30  28.07s
    Epoch 17/30  28.29s
    Epoch 18/30  27.82s
    Epoch 19/30  27.89s
    Epoch 20/30  28.43s
    Epoch 21/30  28.46s
    Epoch 22/30  27.14s
    Epoch 23/30  27.71s
    Epoch 24/30  27.85s
    Epoch 25/30  28.09s
    Epoch 26/30  27.05s
    Epoch 27/30  28.01s
    Epoch 28/30  28.52s
    Epoch 29/30  28.65s
    Epoch 30/30  28.33s
[Low ES / retain_eval (retrain)] n=47000  Acc=94.90  loss=0.149  entr=0.185  margin=5.481
[Low ES / forget_eval (retrain)] n=3000  Acc=44.63  loss=1.884  entr=0.769  margin=1.950

[Step 3/5] Eval retrained (augment X for eval)...
  Retrain -> F:44.63 R:94.90 T:83.89 M:0.796

[Step 4/5] Apply & eval unlearning...
    - Original     F:66.27 R:93.45 T:83.24 M:0.715
    - Fine-tune    F:52.03 R:93.19 T:81.42 M:0.753
    - L1-sparse    F:50.97 R:93.50 T:82.45 M:0.756
    - NegGrad      F:52.27 R:90.16 T:80.40 M:0.734
    - NegGrad+     F:42.07 R:88.71 T:79.14 M:0.733
    - SalUn        F:8.07 R:23.13 T:20.95 M:0.504
    - Random-label F:5.43 R:21.36 T:18.89 M:0.528

--- ES Level: Medium ES ---
[Medium ES / retain_eval (orig)] n=47000  Acc=92.75  loss=0.210  entr=0.249  margin=5.016
[Medium ES / forget_eval (orig)] n=3000  Acc=77.23  loss=0.655  entr=0.736  margin=1.902
[TRAIN] Step 2/5: retrain on retain (augment O)
    Epoch 1/30  28.44s
    Epoch 2/30  28.67s
    Epoch 3/30  28.74s
    Epoch 4/30  28.55s
    Epoch 5/30  28.94s
    Epoch 6/30  28.58s
    Epoch 7/30  28.36s
    Epoch 8/30  28.21s
    Epoch 9/30  28.08s
    Epoch 10/30  28.70s
    Epoch 11/30  28.04s
    Epoch 12/30  28.16s
    Epoch 13/30  28.30s
    Epoch 14/30  28.62s
    Epoch 15/30  29.01s
    Epoch 16/30  28.35s
    Epoch 17/30  28.18s
    Epoch 18/30  28.70s
    Epoch 19/30  28.69s
    Epoch 20/30  28.45s
    Epoch 21/30  28.50s
    Epoch 22/30  28.96s
    Epoch 23/30  29.06s
    Epoch 24/30  28.76s
    Epoch 25/30  29.13s
    Epoch 26/30  29.29s
    Epoch 27/30  29.31s
    Epoch 28/30  28.48s
    Epoch 29/30  29.08s
    Epoch 30/30  29.17s
[Medium ES / retain_eval (retrain)] n=47000  Acc=93.26  loss=0.196  entr=0.230  margin=5.128
[Medium ES / forget_eval (retrain)] n=3000  Acc=56.70  loss=1.367  entr=0.720  margin=2.007

[Step 3/5] Eval retrained (augment X for eval)...
  Retrain -> F:56.70 R:93.26 T:82.89 M:0.713

[Step 4/5] Apply & eval unlearning...
    - Original     F:77.23 R:92.75 T:83.24 M:0.629
    - Fine-tune    F:65.60 R:93.30 T:82.09 M:0.672
    - L1-sparse    F:65.63 R:93.25 T:82.55 M:0.683
    - NegGrad      F:66.47 R:88.95 T:80.23 M:0.629
    - NegGrad+     F:60.23 R:88.37 T:79.52 M:0.665
    - SalUn        F:7.57 R:16.11 T:15.21 M:0.494
    - Random-label F:6.43 R:17.76 T:15.90 M:0.561

--- ES Level: High ES ---
[High ES / retain_eval (orig)] n=47000  Acc=92.46  loss=0.219  entr=0.259  margin=4.985
[High ES / forget_eval (orig)] n=3000  Acc=81.83  loss=0.514  entr=0.580  margin=2.390
[TRAIN] Step 2/5: retrain on retain (augment O)
    Epoch 1/30  28.14s
    Epoch 2/30  28.55s
    Epoch 3/30  28.20s
    Epoch 4/30  28.41s
    Epoch 5/30  28.89s
    Epoch 6/30  28.51s
    Epoch 7/30  28.57s
    Epoch 8/30  28.46s
    Epoch 9/30  28.43s
    Epoch 10/30  28.48s
    Epoch 11/30  27.68s
    Epoch 12/30  28.40s
    Epoch 13/30  28.52s
    Epoch 14/30  27.54s
    Epoch 15/30  27.25s
    Epoch 16/30  28.23s
    Epoch 17/30  28.40s
    Epoch 18/30  28.40s
    Epoch 19/30  28.42s
    Epoch 20/30  28.35s
    Epoch 21/30  28.46s
    Epoch 22/30  28.60s
    Epoch 23/30  28.56s
    Epoch 24/30  28.56s
    Epoch 25/30  28.01s
    Epoch 26/30  28.36s
    Epoch 27/30  28.76s
    Epoch 28/30  28.55s
    Epoch 29/30  28.59s
    Epoch 30/30  28.34s
[High ES / retain_eval (retrain)] n=47000  Acc=93.59  loss=0.188  entr=0.217  margin=5.446
[High ES / forget_eval (retrain)] n=3000  Acc=66.20  loss=1.074  entr=0.573  margin=2.640

[Step 3/5] Eval retrained (augment X for eval)...
  Retrain -> F:66.20 R:93.59 T:83.58 M:0.661

[Step 4/5] Apply & eval unlearning...
    - Original     F:81.83 R:92.46 T:83.24 M:0.579
    - Fine-tune    F:71.20 R:92.40 T:82.29 M:0.629
    - L1-sparse    F:72.57 R:92.64 T:82.60 M:0.618
    - NegGrad      F:75.47 R:89.69 T:81.11 M:0.593
    - NegGrad+     F:73.17 R:89.90 T:80.90 M:0.603
    - SalUn        F:6.93 R:15.75 T:14.41 M:0.510
    - Random-label F:6.97 R:13.97 T:12.84 M:0.487

================ Final Results (MIA) ================

--- Low ES ---
      Method Forget Acc Retain Acc Test Acc   MIA
     Retrain     44.633     94.902   83.890 0.796
    Original     66.267     93.449   83.240 0.715
   Fine-tune     52.033     93.185   81.420 0.753
   L1-sparse     50.967     93.504   82.450 0.756
     NegGrad     52.267     90.162   80.400 0.734
    NegGrad+     42.067     88.713   79.140 0.733
       SalUn      8.067     23.130   20.950 0.504
Random-label      5.433     21.355   18.890 0.528

--- Medium ES ---
      Method Forget Acc Retain Acc Test Acc   MIA
     Retrain     56.700     93.260   82.890 0.713
    Original     77.233     92.749   83.240 0.629
   Fine-tune     65.600     93.300   82.090 0.672
   L1-sparse     65.633     93.253   82.550 0.683
     NegGrad     66.467     88.949   80.230 0.629
    NegGrad+     60.233     88.366   79.520 0.665
       SalUn      7.567     16.109   15.210 0.494
Random-label      6.433     17.760   15.900 0.561

--- High ES ---
      Method Forget Acc Retain Acc Test Acc   MIA
     Retrain     66.200     93.589   83.580 0.661
    Original     81.833     92.455   83.240 0.579
   Fine-tune     71.200     92.402   82.290 0.629
   L1-sparse     72.567     92.645   82.600 0.618
     NegGrad     75.467     89.691   81.110 0.593
    NegGrad+     73.167     89.896   80.900 0.603
       SalUn      6.933     15.747   14.410 0.510
Random-label      6.967     13.966   12.840 0.487
